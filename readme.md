# å®ç°
[TOC]

## todo 
- [x] æ¸²æŸ“dom
- [ ] æ›´æ–°dom
- [ ] æ”¯æŒclass
- [ ] æ”¯æŒfunctionç»„ä»¶
- [ ] æ”¯æŒhooks 
- [ ] diff
- [ ] class setState è¿‡ç¨‹
- [ ] event å§”æ‰˜


### RAF 

### requestIdleCallback
å‘ŠçŸ¥æµè§ˆå™¨ï¼šæœ‰ä»»åŠ¡è¦æ‰§è¡Œï¼Œè¯·åœ¨é—²æš‡æ—¶åˆ»æ‰§è¡Œ
  - requestIdleCallback(workLoop, {timeout: 1000}); // timeout: å‘Šè¯‰æµè§ˆå™¨: åœ¨1000æ¯«ç§’ä¹‹åï¼Œå³ä½¿æ²¡æœ‰ç©ºä½™æ—¶é—´ä¹Ÿè¦å¸®æˆ‘æ‰§è¡Œã€‚
  - workLoop(deadline: {didTimeout: è¯¥ä»»åŠ¡æ˜¯å¦å·²ç»è¶…æ—¶, timeRemaining: timeRemaining()å‘ŠçŸ¥æ­¤å¸§è¿˜å‰©ä½™å¤šå°‘æ—¶é—´})
  - expirationTime: ä¼˜å…ˆçº§æ¦‚å¿µ~
#### MessageChannel


### å•é“¾è¡¨
å•é“¾è¡¨æ˜¯ä¸€ç§é“¾å¼å­˜å‚¨çš„æ•°æ®ç»“æ„
é“¾è¡¨ä¸­çš„æ•°æ®ç”±`èŠ‚ç‚¹`è¡¨ç¤ºçš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç”±å…ƒç´ å’ŒæŒ‡é’ˆæ„æˆ
  - å…ƒç´ ï¼šå­˜å‚¨æ•°æ®çš„å­˜å‚¨å•å…ƒ
  - æŒ‡é’ˆï¼šæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿æ¥æ¯ä¸ªèŠ‚ç‚¹çš„åœ°å€


### fiber
æŠŠä»»åŠ¡æ‹†åˆ†è®¸å¤šä¸ªä»»åŠ¡ï¼ˆä¸€ä¸ªfiberèŠ‚ç‚¹ä¸ºä¸€ä¸ªä»»åŠ¡ï¼‰ï¼Œæ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡
æ¯ä¸ªæ‰§è¡Œå®Œæˆåçœ‹è¿˜æœ‰æ²¡æœ‰æ—¶é—´ï¼Œæœ‰çš„è¯å°±ç»§ç»­æ‰§è¡Œä»»åŠ¡ï¼Œæ²¡æ—¶é—´å°±æ”¾å¼ƒæ‰§è¡Œï¼Œæ‰§è¡Œæƒäº¤ç»™æµè§ˆå™¨

#### fiber å†å²

##### fiber ä¹‹å‰çš„åè°ƒ
reconcilation åè°ƒé˜¶æ®µï¼š 
  - React ä¼šé€’å½’å¯¹æ¯” vDOMï¼Œæ‰¾å‡ºéœ€è¦å˜åŠ¨çš„èŠ‚ç‚¹ï¼Œç„¶ååŒæ­¥æ›´æ–°
  - React åœ¨è¯¥é˜¶æ®µæ˜¯é€’å½’è°ƒç”¨ï¼Œæ‰§è¡Œæ ˆä¼šè¶Šæ¥è¶Šæ·±ï¼Œè€Œä¸”æ— æ³•ä¸­æ–­ï¼Œä¸€æ—¦ä¸­æ­¢ï¼Œå¾ˆéš¾æ¢å¤
    - å¯¼è‡´ç”¨æˆ·äº‹ä»¶æ— æ³•å“åº”
    - æ‰å¸§ï¼šå¡é¡¿

##### fiber æ˜¯ä»€ä¹ˆï¼Ÿ 
###### æ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒ
  - reactç°åœ¨ä½¿ç”¨é“¾è¡¨ï¼Œæ¯ä¸ª virtualDOM ä¸ºä¸€ä¸ªfiber
  - 

###### æ˜¯ä¸€ç§æ•°æ®ç»“æ„

#### fiber é˜¶æ®µ
###### element
è§ element ä¸­çš„ elementï¼Œä¸ºé“¾è¡¨æ•°æ®ç»“æ„

##### renderï¼ˆåè°ƒé˜¶æ®µï¼‰
æŠŠelementè½¬æ¢ä¸ºfiberé“¾è¡¨ï¼Œå¹¶è¿”å›å…¶effecté“¾è¡¨
- ç‰¹ç‚¹
  - å¯è¢«ä¸­æ–­
  - æ‰¾å‡ºæ‰€æœ‰çš„èŠ‚ç‚¹å˜æ›´ï¼ˆå˜æ›´åˆç§°ä¹‹ä¸º==å‰¯ä½œç”¨==ï¼šeffectï¼‰ï¼šåˆ é™¤ã€æ–°å¢ã€å±æ€§å˜æ›´
    - æ‹†åˆ†ç»´åº¦ï¼švirtual dom
- éå†è§„åˆ™ï¼š
  - ä»é¡¶ç‚¹å¼€å§‹
  - å¦‚æœæœ‰`å¤§å„¿å­`ï¼Œåˆ™å…ˆéå†ç¬¬ä¸€ä¸ªï¼ˆå¤§ï¼‰å„¿å­
  - å¦‚æœæ— å¤§å„¿å­ï¼Œæ ‡å¿—è¯¥èŠ‚ç‚¹æ— å­èŠ‚ç‚¹ï¼Œç›´æ¥å®Œæˆ why:
  - å¦‚æœæœ‰`å¼Ÿå¼Ÿ`ï¼Œåˆ™éå†å¼Ÿå¼Ÿ
  - æ²¡æœ‰å¼Ÿå¼Ÿï¼Œåˆ™è¿”å›çˆ¶èŠ‚ç‚¹å¹¶æ ‡è¯†çˆ¶èŠ‚ç‚¹å®Œæˆï¼ˆæ‰€æœ‰çš„å­èŠ‚ç‚¹å®Œæˆååˆ™è‡ªå·±å®Œæˆï¼‰ï¼Œæœ‰`å”å”`ï¼ˆç›¸å¯¹äºå½“å‰èŠ‚ç‚¹ï¼‰åˆ™éå†å”å”
  - æ²¡æœ‰çˆ¶èŠ‚ç‚¹åˆ™éå†ç»“æŸ


- å‰¯ä½œç”¨é“¾è¡¨
  - åˆæ¬¡æ¸²æŸ“
    - å®Œæˆé“¾è§„åˆ™ï¼š æ‰€æœ‰çš„å„¿å­å®Œæˆåˆ™è‡ªå·±å®Œæˆï¼Œwhy: ä¸æ˜¯ç”Ÿæˆåå°±æŒ‚è½½ï¼Œè€Œåˆ†æˆäº†ä¸¤ä¸ªé˜¶æ®µï¼Ÿ
    - effecté“¾ï¼šç­‰åŒäºå®Œæˆé“¾ï¼Œç”¨äºä¸‹ä¸€ä¸ªé˜¶æ®µ
    - summary: æ¸²æŸ“æ—¶ï¼Œä»ç¥–å…ˆèŠ‚ç‚¹å¼€å§‹æŒ‚è½½: ç”±ä¸Šè€Œä¸‹çš„é¡ºåº

  - åç»­æ›´æ–°
    - è®¡ç®—å‡ºå…¶æ›´æ”¹

##### commit
æäº¤é˜¶æ®µï¼šå°†ä¸Šä¸€ä¸ªé˜¶æ®µè®¡ç®—å‡ºæ¥çš„éœ€è¦å¤„ç†çš„å‰¯ä½œç”¨ï¼ˆEffectsï¼‰ä¸€æ¬¡æ€§æ‰§è¡Œï¼Œè¿™ä¸ªèŠ‚ç‚¹å¿…é¡»åŒæ­¥æ‰§è¡Œï¼Œä¸èƒ½è¢«æ‰“æ–­ï¼ˆå¦åˆ™ï¼šæƒ³è±¡ä¸€ä¸‹èŠ‚ç‚¹ä¸€ä¸ªä¸€ä¸ªçš„è¹¦å‡ºæ¥ï¼Œæˆ–è€…çªç„¶ä¸€æ®µæ–‡ä»¶å¢åŠ  ğŸ˜… ï¼‰

- DOM æ›´æ–°åˆ›å»ºé˜¶æ®µ


#### æ›´æ–°ï¼ˆæ— difféƒ¨åˆ† -> keyï¼‰

### classç±»ç»„ä»¶ + setState

### å‡½æ•°å¼ç»„ä»¶ + hooks